Fig. 1 Study design and clinical relevance of AFP status in HCC single-cell cohorts. a, Schematic overview of the study design. b, Clinical characterization of the single-cell cohort samples between AFP positive (AFP_Pos) and AFP negative (AFP_Neg) HCC. Fisher’s exact test p-values for the association between AFP status and clinical features are shown on the right, with significant associations highlighted in red. c, Kaplan–Meier survival analysis based on AFP status. The upper panel shows survival curves for the scRNA-seq cohort, and the lower panel shows validation survival curves from the TCGA-LIHC cohort. p-values were calculated using the log-rank test. d, UMAP visualization of major cell populations identified across the scRNA-seq dataset. e, Bubble plots showing the expression of canonical marker genes across these cell populations


Fig. S1 Clinical and cellular composition differences between AFP+ and AFP- HCC samples. a, Clinical characteristics of TCGA-LIHC samples comparing AFP_Pos and AFP_Neg groups. Fisher’s exact test p-values for association with AFP status are shown on the right, with significant associations in red. b, Stacked bar plot showing the cell percent ratio of major cell types in AFP_Pos and AFP_Neg groups. c, Box plots comparing the relative abundance of major cell populations between AFP_Pos and AFP_Neg groups. *, p < 0.05; **, p < 0.01; NS, not significant


Fig. 2 The majority cell subclusters of malignant cells AFP+ HCC. a–b, UMAP projections of tumor cell clusters (a) and their distribution between AFP_Pos and AFP_Neg HCC samples (b). c, Bubble plot showing the expression of canonical marker genes across tumor cell subsets. Dot size indicates the fraction of cells expressing each gene; color represents average expression. d, Heat map showing the Ro/e value of tumor cell subsets in AFP_Pos versus AFP_Neg tumors. e, Box plots comparing the relative abundance of Tumor_C1, Tumor_C3, and Tumor_C6 subsets between AFP_Pos and AFP_Neg groups. *, p < 0.05; **, p < 0.01; NS, not significant. f, Box plots showing signature scores of the top 50 marker genes of Tumor_C1, Tumor_C3, and Tumor_C6 subsets in the TCGA-LIHC cohort grouped by AFP status. g, Kaplan–Meier survival curves based on signature scores of the top 50 marker genes for Tumor_C1, Tumor_C3, and Tumor_C6 subsets in the TCGA-LIHC cohort. h, Bar plots showing GO biological process (GOBP) enrichment of marker genes from Tumor_C1, Tumor_C3, and Tumor_C6 subsets. i, Bar plot showing GOBP enrichment of differentially expressed genes between AFP_Pos and AFP_Neg samples in the TCGA-LIHC cohort


Fig. 2 The majority cell subclusters of malignant cells AFP+ HCC. a–b, UMAP projections of tumor cell clusters (a) and their distribution between AFP_Pos and AFP_Neg HCC samples (b). c, Bubble plot showing the expression of canonical marker genes across tumor cell subsets. Dot size indicates the fraction of cells expressing each gene; color represents average expression. d, Heat map showing the Ro/e value of tumor cell subsets in AFP_Pos versus AFP_Neg tumors. e, Box plots comparing the relative abundance of Tumor_C1, Tumor_C3, and Tumor_C6 subsets between AFP_Pos and AFP_Neg groups. *, p < 0.05; **, p < 0.01; NS, not significant. f, Box plots showing signature scores of the top 50 marker genes of Tumor_C1, Tumor_C3, and Tumor_C6 subsets in the TCGA-LIHC cohort grouped by AFP status. g, Kaplan–Meier survival curves based on signature scores of the top 50 marker genes for Tumor_C1, Tumor_C3, and Tumor_C6 subsets in the TCGA-LIHC cohort. h, Bar plots showing GO biological process (GOBP) enrichment of marker genes from Tumor_C1, Tumor_C3, and Tumor_C6 subsets. i, Bar plot showing GOBP enrichment of differentially expressed genes between AFP_Pos and AFP_Neg samples in the TCGA-LIHC cohort


Fig. S2 SCENIC analysis in Tumor_C1_FABP1, Tumor_C3_STMN1 and Tumor_C6_AFP. a, Heatmap of inferred transcription factor (TF) activity based on SCENIC analysis. b, Heatmap showing the expression of target genes corresponding to the TFs identified in Figure S2a


Fig. 3 Treg-mediated immunosuppressive environment in AFP-positive HCC. 
a–b, UMAP projections of 14 T cell clusters (a) and their distribution between AFP_Pos and AFP_Neg HCC samples (b). c, Heat map showing the Ro/e value of T cell subsets in AFP_Pos versus AFP_Neg tumors. d, Bubble plot showing the expression of canonical marker genes across T cell subsets. Dot size indicates the proportion of cells expressing each gene; color reflects average expression level. e, Heatmap showing scaled signature scores of 19 curated gene programs across T cell subsets. f, Box plots comparing the relative abundance of CD8T_C1, CD8T_C5, and Treg subsets between AFP_Pos and AFP_Neg groups. *, p < 0.05; **, p < 0.01; NS, not significant. g, Kaplan–Meier survival curves based on the marker gene signature scores of CD8T_C1_GZMK and Treg subsets calculated in TCGA-LIHC cohort. h, Violin plots displaying the expression of inhibitory immune checkpoint genes (PDCD1, CTLA4, LAG3, TIGIT, HAVCR2) in each T cell subset. i, Differential gene expression (log₂FC) between AFP_Pos and AFP_Neg tumors within each T cell subset. Numbers above and below indicate the number of significantly upregulated (red) and downregulated (blue) genes, respectively


Fig. S3 Functional states, developmental trajectory, and transcriptional regulation of CD8+ T cells associated with AFP status. a, Bubble plot showing the expression of differentiation-associated genes across CD8+ T cell subsets. b, Bar plot of downregulated Gene Ontology Biological Process (GOBP) pathways in the AFP_Pos group relative to the AFP_Neg group for the total CD8+ T cell population. c, Violin plots comparing the cytotoxicity scores (left) and exhaustion scores (right) of the total CD8+ T cell population between AFP_Pos and AFP_Neg patients. The Wilcoxon rank-sum test was used for statistical comparison. ***p < 0.001. d, UMAP plot showing the identified subsets of CD8+ T cells. e–f, Pseudotime trajectory analysis of CD8+ T cells, coloured by cell subtype (d) and pseudotime value (e). g, Smoothed expression trends of four functional gene set signatures (Naive, Cytotoxicity, Proliferation and Exhaustion) along the pseudotime trajectory, modelled using Gaussian process regression with the 95% confidence interval. h, Smoothed trends of cytotoxicity signature scores along the pseudotime trajectory in AFP_Pos and AFP_Neg groups, modelled using Gaussian process regression with the 95% confidence interval. i, Bubble heatmap illustrating the activity of the top 5 transcription factors (TFs) for each CD8+ T cell subset, as identified by SCENIC analysis. j, Heatmap displaying the dynamic expression patterns of key genes along the pseudotime trajectory. The top panel shows the density distribution of different cell subtypes across pseudotime. The heatmap displays the Z-score of gene expression. Genes highlighted in red text are target genes for the transcription factors shown in (h), and other important marker genes are also indicated


Fig. 4 CD1C+ and CXCL10+ DCs were dominate in AFP+ HCC. a, UMAP plot showing the identified subsets of DC cells. b, Bubble plot showing the expression of canonical marker genes across DC cell subsets. Dot size indicates the fraction of cells expressing each gene; color represents average expression. c, Stacked bar plots showing the cell proportions of DC subsets in AFP_Pos and AFP_Neg tumors. d, Heat map showing the Ro/e value of DC cell subsets in AFP_Pos versus AFP_Neg tumors. e, Box plots comparing the relative abundance of DC_C5_CXCL10 and DC_C1_CD1C subsets between AFP_Pos and AFP_Neg groups. *p < 0.05; **p < 0.01. f, Volcano plots showing differentially expressed genes between AFP_Pos and AFP_Neg tumors in each DC cell subset. g, Bar plots showing the KEGG pathway enrichment of downregulated differentially expressed genes between AFP_Pos and AFP_Neg groups in DC_C1_CD1C and DC_C5_CXCL10 subsets. h, Bubble plot showing the expression of key genes related to "Antigen processing and presentation" in DC_C1_CD1C and DC_C5_CXCL10 subsets grouped by AFP status


Fig. 5 CXCL10+ DCs positive correlated with Tregs in AFP+ HCC. a, Heatmap of co-occurrence patterns among T cells, DCs and tumor subpopulations (Tumor_C1_FABP1, Tumor_C3_STMN1, Tumor_C6_AFP). Color scale indicates Spearman correlation coefficients (*p < 0.05). Black boxes highlight clusters identified by hierarchical clustering. b, Scatter plots showing the Spearman correlation between the cell proportions of Treg and DC_C5_CXCL10 and serum AFP levels. c, Lollipop plot showing the Spearman correlation between Treg and DC_C5_CXCL10 signature scores across 25 independent bulk RNA-seq datasets. d, Validation of the correlation between Treg and DC_C5_CXCL10 using the scRNA-Seq Validation Dataset (GSE151530). d, UMAP projection of major cell types. e, UMAP plots showing the distribution of Treg (right) and DC_C5_CXCL10 (left) signature scores in T and myeloid cells. f, Scatter plot showing the Spearman correlation between the mean Treg and DC_C5_CXCL10 signature scores per sample. g, Spatial co-localization of Treg and DC_C5_CXCL10 using spatial transcriptomics data. (i) Spatial annotation of the HCC4L sample, with Mal, nMal, and Bdy representing malignant, non-malignant, and boundary regions, respectively. (ii) Spatial expression distribution of AFP. (iii) Spatial distribution of Treg and DC_C5_CXCL10 signature scores. (iv) Spatial distribution of Treg and DCs based on single-cell mapping results from CellTrek deconvolution analysis. (v) Box plots showing the spatial K-distance of DC subsets to Treg, with Kruskal–Wallis test used to assess differences in medians between groups


Fig. S4 Interactions between dendritic cell subsets and Tregs in the HCC microenvironment. a, Heat map showing the cell-cell communication network of CXCL signaling between DC subsets and Tregs, indicating the importance of each subset as sender, receiver, mediator, or influencer. b, Comparison of ligand-receptor pairs between DC subsets and Tregs in AFP+ and AFP- HCC. Dot color represents communication probability between sender and receiver clusters, and dot size indicates statistical significance (p < 0.01)


Fig. 6 CXCL10+ DCs and Tregs correlating with poor response to anti-PD-1 therapy. a, Kaplan–Meier survival curves for the GSE202069 anti-PD-1 therapy dataset, grouped by high and low signature scores of Tumor_C1, Tumor_C3, Tumor_C6, and Treg. b–e, scRNA-Seq Validation Dataset (GSE235863) for anti-PD-1 plus Lenvatinib combination therapy. b, UMAP projection of major cell types. c, UMAP plots showing the distribution of Treg (right) and DC_C5_CXCL10 (left) signature scores in T and myeloid cells. d, Scatter plot showing the Spearman correlation between the mean Treg and DC_C5_CXCL10 signature scores per sample in all pre-treatment samples. e, Violin plots displaying DC_C5_CXCL10 scores in pre- and post-treatment samples from non-responders (NR) and responders (R). f, Spatial transcriptomics Validation Dataset (from Xun, et al.) for anti-PD-1 therapy, including 8 samples (5 NR and 3 R). f, Heatmap showing the average spatial K-distance of DC subsets to Treg, derived from CellTrek analysis. The distance is normalized within each sample. g, Box plot showing the scaled spatial distance of all DC_C5_CXCL10 cells to Treg in NR and R spatial transcriptomics samples. h, Spatial co-localization of Treg and DC_C5_CXCL10 in two representative samples from non-responder (upper panel) and Responder (lower panel). (i) Original annotation of the regions. (ii) Spatial expression distribution of AFP. (iii) Spatial distribution of DC_C5_CXCL10 and Treg signature scores. (iv) Spatial distribution of Treg and DCs based on single-cell mapping results from CellTrek deconvolution analysis. (v) Box plots showing the spatial K-distance of various DC subsets to Treg, with Kruskal–Wallis test used to assess differences in medians between groups


Fig. S5 Tregs associate with immunotherapy resistance and spatial co-localization with dendritic cells in the HCC microenvironment. a, Violin plots displaying Treg scores in CD4+ T cells from pre- and post-treatment samples of non-responders (NR) and responders (R). ***p < 0.001; NS, not significant. b-c, Spatial distribution of Tregs and DCs based on CellTrek single-cell mapping (left). Box plots show the spatial K-distance between Tregs and various DC subsets (right), with Kruskal–Wallis test assessing differences in median distances

